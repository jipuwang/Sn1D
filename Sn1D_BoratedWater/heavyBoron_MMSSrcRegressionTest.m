% This is a regression test for refactoring code MMS source case. 
% J=120;
% N=4;
clear;
Sn_1D_kord_MMSSrc()
% reference solution
[ref_phi0_g1,ref_phi0_g2]=ref();
% create global phi0_j_g1 and phi0_j_g2 so you can access the flux outside
% of the function
global getter_phi0_j_g1 getter_phi0_j_g2
error_g1=max(getter_phi0_j_g1-ref_phi0_g1)
error_g2=max(getter_phi0_j_g2-ref_phi0_g2)





%% reference solution
function [ref_phi0_g1,ref_phi0_g2]=ref()
  ref_phi0_g1=[0.0637696115802781;0.0640087577834014;0.0650273173894111;0.0668268659894122;0.0694087850068732;0.0727743117818350;0.0769245797022614;0.0818606506025067;0.0875835411836598;0.0940942448484192;0.101393750062688;0.109483056140610;0.118363187186480;0.128035204806167;0.138500220115137;0.149759405514776;0.161814006680111;0.174665355198472;0.188314882319825;0.202764134326620;0.218014790106740;0.234068681621873;0.250927818111753;0.268594415070798;0.287070929289296;0.306360101581384;0.326465009246111;0.347389130850728;0.369136426619119;0.391711438593749;0.415119415869001;0.439366471633906;0.464459780598135;0.490407827715137;0.517220722098833;0.544910593831522;0.573492096205482;0.602983042115629;0.633405211190778;0.664785374282096;0.703109022228653;0.746667795811280;0.787799669457262;0.826535353680692;0.862899511829235;0.896912046471286;0.928589099828836;0.957943832337464;0.984987028975936;1.00972757182141;1.03217280861817;1.05232884042937;1.07020074623228;1.08579275827543;1.09910839887738;1.11015058690440;1.11892172025941;1.12542373922176;1.12965817429967;1.13162618131678;1.13132856569107;1.12876579722744;1.12393801619369;1.11684503094806;1.10748630690096;1.09586094609432;1.08196765613505;1.06580470659002;1.04736987019713;1.02666034532179;1.00367265492978;0.978402515880523;0.950844670473256;0.920992669779840;0.888838595215188;0.854372700827044;0.817582953671306;0.778454443041534;0.736968620808987;0.693102324143979;0.654727399787224;0.623513157332702;0.593233010937941;0.563866720607886;0.535397835159594;0.507812913393332;0.481100910582742;0.455252694821296;0.430260665393235;0.406118451324365;0.382820672965492;0.360362753146888;0.338740767333938;0.317951324482946;0.297991472076267;0.278858620212456;0.260550480722767;0.243065018144551;0.226400410055812;0.210555014803000;0.195527345067273;0.181316046037192;0.167919877207237;0.155337697016304;0.143568449690008;0.132611153763907;0.122464891848258;0.113128801253590;0.104602065133525;0.0968839038191044;0.0899735660183483;0.0838703195358015;0.0785734411282548;0.0740822050522958;0.0703958697732551;0.0675136621883178;0.0654347585621050;0.0641582611717368;0.0636831693983007;0.0640083436673561];
  ref_phi0_g2=[0.0140257777489809;0.0165204781584563;0.0191492211196732;0.0219449403394982;0.0249181448669216;0.0280726324199390;0.0314101181409780;0.0349315884006716;0.0386376869106906;0.0425288144723671;0.0466051432655095;0.0508666046539394;0.0553128675698514;0.0599433121662956;0.0647569997723364;0.0697526390962803;0.0749285482812972;0.0802826122878296;0.0858122349993855;0.0915142853748444;0.0973850368858121;0.103420099375353;0.109614342350087;0.115961808566368;0.122455616587107;0.129087850760850;0.135849436797928;0.142730000772112;0.149717708925649;0.156799085015872;0.163958800866010;0.171179433488357;0.178441176050441;0.185721471393422;0.192994476584735;0.200230066411336;0.207391409031025;0.214427868974566;0.221252290386071;0.227665657306047;0.235713346042209;0.245800918251173;0.255931926343449;0.265794474650557;0.275242323047998;0.284198979320398;0.292620177136997;0.300478258751284;0.307755066897702;0.314438339252213;0.320519673404312;0.325993275450823;0.330855144550402;0.335102522913713;0.338733517891568;0.341746840090574;0.344141621571205;0.345917290192726;0.347073483898936;0.347609993988991;0.347526730141161;0.346823702723719;0.345501020117856;0.343558900678172;0.340997700808932;0.337817962674326;0.334020487553407;0.329606444136984;0.324577525643579;0.318936176329436;0.312685918332150;0.305831827106525;0.298381235706063;0.290344814301149;0.281738322882180;0.272585710540699;0.262925213037451;0.252822726181069;0.242403895827669;0.231936076275466;0.223471188998534;0.216728494052649;0.209677117871293;0.202481690406622;0.195213210778775;0.187912321253608;0.180608353639729;0.173325253132617;0.166083580835203;0.158901321503779;0.151794308274118;0.144776509131715;0.137860251425853;0.131056410216807;0.124374570737455;0.117823170201101;0.111409622319725;0.105140427041917;0.0990212675216569;0.0930570959823392;0.0872522098752419;0.0816103195199792;0.0761346082425278;0.0708277858855403;0.0656921364498205;0.0607295605304749;0.0559416131327156;0.0513295373871736;0.0468942946281372;0.0426365912392690;0.0385569025761070;0.0346554940302112;0.0309324385254489;0.0273876271440509;0.0240207608068127;0.0208312812149858;0.0178180986389943;0.0149786335365345;0.0123055362532530;0.00977554808194017];
end